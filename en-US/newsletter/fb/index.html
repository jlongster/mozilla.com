<?php
    require_once "{$config['file_root']}/includes/regions.php";
    require_once "{$config['file_root']}/includes/email/forms.php";

    $status = '';

    if(isset($_POST['target']) && $_POST['target'] == 'main') {
        $form = new NewsletterForm('MOZILLA_AND_YOU', $_POST);
        if ($form->save()) {
            $status = 'success';
        } elseif ($form->error) {
            $status = 'error-'. $form->error;
        }
    }
    else {
        $form = new NewsletterForm('MOZILLA_AND_YOU', array());
    }
?>
<!DOCTYPE html>
<html>
    <head>
        <title>Mozilla Newsletter</title>
        <meta name="og:image" content="/cdn/img/firefox-100.jpg"> 
        <style> 
        /* MetaWebPro font family licensed from fontshop.com. WOFF-FTW! */
        @font-face {
            font-family: 'MetaBlack';
            src: url('/cdn/img/fonts/MetaWebPro-Black.eot');
            src: local('☺'), url('/cdn/img/fonts/MetaWebPro-Black.woff') format('woff');
            font-weight: bold;
        }
        </style>
        <link rel="stylesheet" href="style/newsletter.css" media="screen" />
    </head>
    <body>
        <div id="main-content">
            <div id="blurb">
                <h2>
                    Read all about it in our <span>NEWSLETTER</span>
                </h2>
                <p>
                    Subscribe to monthly updates and keep current with Mozilla news, including the latest tips and tricks for getting the most out of your Firefox browser. <br /><br />
                    It’s the perfect way for us to keep in touch!
                </p>
            </div>
            <div id="form-content">
                <form method="post">
                    <div class="clearfix">
                        <label for="email" class="label"><b>Your email address:</b></label> 
                        <div class="form_item">
                            <input type="text" name="email" />
                        </div>
                    </div>
                    <div class="clearfix">
                        <label for="country" class="label">Country:</label> 
                        <div class="form_item">
                            <select class="country" name="country">
                                <option value="">Select country</option>
                                <?php 
                                    $country = $form->get('country');
                                    if (!$country) {
                                        $country = 'us';
                                    }
                                    echo regionsAsOptions($lang, $country);
                                ?>
                            </select>
                        </div>
                    </div>
                    <div class="clearfix">
                        <label for="format" class="label">Format:</label> 
                        <div class="form_item">
                            <input type="radio" name="format" value="html" checked="checked" /> HTML 
                            <input type="radio" name="format" value="text" /> Text
                        </div>
                    </div>
                    <div class="clearfix">
                        <div class="label">&nbsp;</div>
                        <div class="form_item">
                            <input type="checkbox" name="privacy" id="privacy" /> I agree to the <a href="/en-US/privacy-policy">Mozilla Privacy Policy</a>
                        </div>
                    </div>
                    <div class="clearfix">
                        <div class="label">&nbsp;</div>
                        <div class="form_item">
                            <input type="submit" id="submit" value="Sign me up!" /><br />
                            <span class="small_text">We will only send you Mozilla-related information.</span>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </body>
</html>
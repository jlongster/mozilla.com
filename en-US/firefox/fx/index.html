<?php
    require_once "{$config['file_root']}/includes/helpers.php";

    $page_title = 'Mozilla Firefox Web Browser';
    $body_id    = 'home-fx';
    $extra_headers = <<<EXTRA_HEADERS
    <meta name="description" content="Mozilla Firefox is created by a global non-profit dedicated to putting individuals in control and shaping the future of the web for the public good." />
    <meta name="WT.ad" content="Download Firefox;Participate;Amazing Features;Need Help;Twitter;Facebook;Connect;Newsletter;Mobile;Addons;Personas" />
    <link rel="stylesheet" href="{$config['static_prefix']}/style/covehead/home-fx.css" media="screen" />
    <script src="{$config['static_prefix']}/js/jquery/jquery-css-transform.js"></script>
    <script src="{$config['static_prefix']}/js/jquery/jquery-animate-css-rotate-scale.js"></script>
EXTRA_HEADERS;
    include_once "{$config['file_root']}/{$lang}/includes/header.inc.php";
?>

<div id="main-feature">
    <h2>Good news! Your Firefox is up to date. <span>Discover More Awesome</span></h2>

    <div id="wheel-frame" class="a">
        <span id="spin" onclick="javascript:window.switchPage()">
          <img src="<?=$config['static_prefix']?>/img/covehead/firefox/fx/spinner.png" alt="Click to Spin" height="90" width="89">
        </span>
        <div id="wheel" onclick="javascript:window.switchPage()">
            <div id="section-a" class="section">Mobile</div>
            <div id="section-b" class="section">Add-ons</div>
            <div id="section-c" class="section">New Look</div>
        </div>
        <img src="<?=$config['static_prefix']?>/img/covehead/firefox/fx/stand.png" alt="" id="wheel-stand">
        <div id="wheel-creature"></div>
        <div id="wheel-panel" class="pager pager-no-history">

            <div class="pager-content">

                <div class="wheel-panel-contents" id="feature-a">
                    <script>// <![CDATA[
                    document.getElementById('feature-a').id = 'page-feature-a';
                    // ]]></script>
                    <h3>Bring Firefox <span>With You!</span></h3>
                    <ul>
                        <li>Sync your desktop and mobile</li>
                        <li>Customize with add-ons</li>
                        <li>Type less, browse more</li>
                    </ul>
                    <p><a href="/<?=$lang?>/mobile/download/"
                          onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                                 'DCS.dcsuri', '/<?=$lang?>/mobile/download/',
                                                 'WT.ti', 'Link: Get Firefox on your Phone',
                                                 'WT.dl', 99,
                                                 'WT.nv', 'Wheel - Mobile',
                                                 'WT.ac', 'Mobile');">
                        Get Firefox on your phone »
                    </a></p>
                </div>

                <div class="wheel-panel-contents" id="feature-c">
                    <script>// <![CDATA[
                    document.getElementById('feature-c').id = 'page-feature-c';
                    // ]]></script>
                    <h3>Make Your Firefox <span>Supercharged</span></h3>
                    <ul>
                        <li id="addon-invisiblehand">
                            <a href="https://addons.mozilla.org/en-US/firefox/addon/11377/?src=mozcom-wheel"
                               onclick="dcsMultiTrack('DCS.dcssip', 'addons.mozilla.org',
                                                      'DCS.dcsuri', '/en-US/firefox/addon/11377/',
                                                      'WT.ti', 'Link: Addon - InvisibleHand',
                                                      'WT.dl', 99,
                                                      'WT.nv', 'Wheel - Addons',
                                                      'WT.ac', 'Addons');">
                                <span class="title">InvisibleHand</span>
                                <span class="desc">Automatically get the lowest price when you  shop online.</span>
                            </a>
                        </li>
                        <li id="addons-cooliris">
                            <a href="https://addons.mozilla.org/en-US/firefox/addon/5579/?src=mozcom-wheel"
                               onclick="dcsMultiTrack('DCS.dcssip', 'addons.mozilla.org',
                                                      'DCS.dcsuri', '/en-US/firefox/addon/5579/',
                                                      'WT.ti', 'Link: Addon - Cooliris',
                                                      'WT.dl', 99,
                                                      'WT.nv', 'Wheel - Addons',
                                                      'WT.ac', 'Addons');">
                                <span class="title">Cooliris</span>
                                <span class="desc">A stunning way to browse photos and videos from the Web.</span>
                            </a>
                        </li>
                        <li id="addon-reminderfox">
                            <a href="https://addons.mozilla.org/en-US/firefox/addon/1191/?src=mozcom-wheel"
                               onclick="dcsMultiTrack('DCS.dcssip', 'addons.mozilla.org',
                                                      'DCS.dcsuri', '/en-US/firefox/addon/1191/',
                                                      'WT.ti', 'Link: Addon - ReminderFox',
                                                      'WT.dl', 99,
                                                      'WT.nv', 'Wheel - Addons',
                                                      'WT.ac', 'Addons');">
                                <span class="title">ReminderFox</span>
                                <span class="desc">Make sure you remember all of your important dates.</span>
                            </a>
                        </li>
                    </ul>
                    <p><a href="https://addons.mozilla.org/firefox/?src=mozcom-wheel"
                          onclick="dcsMultiTrack('DCS.dcssip', 'addons.mozilla.org',
                                                 'DCS.dcsuri', '/en-US/firefox/',
                                                 'WT.ti', 'Link: View All Addons',
                                                 'WT.dl', 99,
                                                 'WT.nv', 'Wheel - Addons',
                                                 'WT.ac', 'Addons');">
                        View all Firefox Add-ons »
                    </a></p>
                </div>

                <div class="wheel-panel-contents" id="feature-b">
                    <script>// <![CDATA[
                    document.getElementById('feature-b').id = 'page-feature-b';
                    // ]]></script>
                    <h3>Browsing <span>Made Easy</span></h3>
                    <p>Firefox 4 has been designed by a team of experts and tested by millions of users around the world to make sure your browsing is as intuitive and easy as possible.</p>
                    <a href="/<?=$lang?>/firefox/central/">Take the Tour »</a>
                </div>

            </div>

        </div>
    </div>
</div>

<hr id="feature-divider">

<div id="main-content">

    <div class="sub-feature" id="sub-firefox">
        <h3>Get <span>Firefox</span></h3>
        <p>If you need a fresh new copy of Firefox, you can get it here:</p>
        <div id="home-fx-download">
        <script src="/js/download.js"></script>
        <?php
            $_options = array('ancillary_links' => true, 'layout' => 'subpage', 'download_parent_override' => 'home-fx-download', '_include_js' => true, 'download_product' => 'Firefox');
            echo $firefoxDetails->getNoScriptBlockForLocale('en-US', $_options);
            echo $firefoxDetails->getDownloadBlockForLocale('en-US', $_options);
        ?>
        </div>
    </div>

    <div class="sub-feature" id="sub-participate">
        <h3>Have Fun and <span>go mobile</span></h3>
        <p>Share Firefox 4 for Android - play Spark!</p>
        <a href="http://spark.mozilla.org/">
          Start playing <span>»</span>
        </a>
    </div>

    <div class="sub-feature" id="sub-support">
        <h3>The Web <span>Belongs to You</span></h3>
        <p>Visit Mark Up and show your support.</p>
        <a href="https://markup.mozilla.org/" 
           onclick="dcsMultiTrack('DCS.dcssip', 'markup.mozilla.org', 
                                  'DCS.dcsuri', '/', 
                                  'WT.ti', 'Link: Make your mark',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Make your mark');">
           Make your mark <span>»</span>
        </a>
    </div>

</div>

<?php
    $extra_footers = <<<EXTRA_FOOTERS
    <script src="/js/mozilla-pager.js"></script>
    <script>

    $(document).ready(function() {

        var \$container = \$('#wheel-frame');
        var panelId     = 'wheel-panel';
        var \$panel     = \$('#wheel-panel');
        var wheel       = document.getElementById('wheel');
        var \$wheel     = \$(wheel);
        var page        = 0;

        var useTransitions = false;
        (function() {
            var div = document.createElement('div');
            div.innerHTML = '<div style="'
                + '-webkit-transition: color 1s linear;'
                + '-moz-transition: color 1s linear;'
                + '-ms-transition: color 1s linear;'
                + '-o-transition: color 1s linear;'
                + '"></div>';

            useTransitions =
                   (div.firstChild.style.webkitTransition !== undefined)
                || (div.firstChild.style.MozTransition !== undefined)
                || (div.firstChild.style.msTransition !== undefined)
                || (div.firstChild.style.OTransition !== undefined);

            delete div;
        })();

        var angle;
        if (useTransitions) {
            angle = -360.0; // start at an angle to fix font rendering in Windows
        } else {
            angle = 0.0;
        }

        if (typeof wheel.addEventListener != 'undefined') {
            wheel.addEventListener(
                'webkitTransitionEnd',
                showPanel,
                true
            );

            wheel.addEventListener(
                'transitionend',
                showPanel,
                true
            );
        } else {
            wheel.addEvent(
                'transitionend',
                showPanel
            );
        }

        function showPanel()
        {
            Mozilla.Pager.pagers[panelId].setPage(
                Mozilla.Pager.pagers[panelId].pages[page]
            );

            if (useTransitions) {
                \$panel
                    .css('opacity', 1.0)
                    .css('bottom', 0);
            } else {
                \$panel.animate({ opacity: 1.0, bottom: 0 }, 400);
            }
        }

        function switchPage()
        {
            hidePanel();
            spinWheel();

            if(\$container.hasClass('a')) {
                \$container.removeClass('a');
                \$container.addClass('b');
                page = 1;
            } else if (\$container.hasClass('b')) {
                \$container.removeClass('b');
                \$container.addClass('c');
                page = 2;
            } else if (\$container.hasClass('c')) {
                \$container.removeClass('c');
                \$container.addClass('a');
                page = 0;
            }
        }

        function hidePanel()
        {
            if (useTransitions) {
                \$panel
                    .css('opacity', 0)
                    .css('bottom', -278);
            } else {
                \$panel.animate({ opacity: 0.0, bottom: -278 }, 400);
            }
        }

        function spinWheel()
        {
            angle -= 480.0;

            if (useTransitions) {
                \$wheel.rotate(angle);
            } else {
                \$wheel.animate({rotate: angle}, 800, 'linear', showPanel);
            }
        }

        window.switchPage = switchPage;
    });

    </script>

EXTRA_FOOTERS;
    include_once "{$config['file_root']}/{$lang}/includes/footer.inc.php";
?>

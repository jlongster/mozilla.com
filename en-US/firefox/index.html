<?php
    require_once "{$config['file_root']}/includes/min/inline.php";

    $page_title = 'Mozilla | Firefox web browser &amp; Thunderbird email client';
    $body_id    = 'home';

    $fonts      = ' '; // Remove fonts cause IE will download them anyway
    $styles     = ' '; 
    $all_css    = min_inline_css('css');
    $home_css   = min_inline_css('css_home');

    $extra_headers = <<<EXTRA_HEADERS
    <!-- Please do not ever remove this comment. -->
    <meta name="keywords" content="Firefox, Mozilla Firefox, Mozilla, Thunderbird, Thunderbird 2, Thunderbird email, email, Firefox 2, Foxfire, Fire Fox, browser, web browser, internet browser, web, pop-up blocker, internet, speed, secure, customize, online, add-ons, fastest, download Firefox" />
    <meta name="description" content="Mozilla is a global community dedicated to building free, open source products like the award winning Firefox web browser and Thunderbird email software." />
    <meta name="WT.ad" content="Download Firefox;Tour;Security;Go Fast;Customize;Beta" />
    {$all_css}
    {$home_css}
EXTRA_HEADERS;

    $head_scripts = min_inline_js('js_utils');
    include_once "{$config['file_root']}/{$lang}/includes/header.inc.php";
?>
<?php
    // Funnelcake Config
    $_product_details_options = array();
    if (array_key_exists('funnelcake_suffix', $config) && !empty($config['funnelcake_suffix'])) {
        $_product_details_options['tweaks'] = array('/'.LATEST_FIREFOX_VERSION.'/' => LATEST_FIREFOX_VERSION.$config['funnelcake_suffix']);
        echo <<<FUNNEL
<script>// <![CDATA[
  var gDownloadFunnelCake = '{$config['funnelcake_suffix']}';
// ]]></script>
FUNNEL;
    }
?>

<div id="main-feature">
    <div id="upgrade">
        <h3>Mozilla Firefox</h3>
        <p>Your web, the way you like it:</p>
        <ul>
            <li>high performance</li>
            <li>easy customization</li>
            <li>advanced security</li>
        </ul>
        <?=buildPlatformImage($config['static_prefix'].'/img/home/screenshot-main.png', 'Firefox screenshot', null, null, null, array('mac', 'linux'))?>
    </div>
    <div id="home-download">
    <script><?php include $config['file_root'] . '/js/download.old.js';?></script>
    <script>
        <!--
        // Configure the Firefox download write script

        var gDownloadTracker = "dcsMultiTrack('DCS.dcssip', 'www.mozilla.com', 'DCS.dcsuri', '/en-US/products/download.html', 'WT.ti', 'Link: Get Firefox', 'WT.dl', 99, 'WT.nv', 'Content', 'WT.ac', 'Download Firefox');";

        var gDownloadItemTemplate = " <li class=\"%CSS_CLASS%\"> <a onclick=\"" + gDownloadTracker + " do_download('%BOUNCER_URL%');\" href=\"%DOWNLOAD_URL%\" class=\"download-link download-firefox\"><span class=\"download-content\"><span class=\"download-title\">Firefox 3.6 <img src=\"<?=$config['static_prefix']?>/img/home/download-arrow.png\" alt=\"\" id=\"download-arrow\"></span> Free Download <span class=\"download-info\">%VERSION% for %PLATFORM_NAME% <em class=\"download-lang\">%LANGUAGE_NAME%<\/em><\/span><\/span><\/a> <\/li>";
        var gDownloadItemMacOS9 = "<a href=\"\">MacOS 9 and earlier are not supported<\/a>";
        var gDownloadItemOtherPlatform = "<a href=\"/<?=$lang?>/firefox/<?=LATEST_FIREFOX_VERSION?>/releasenotes/#contributedbuilds\" onclick=\"" + gDownloadTracker + "\">Free Download<\/a>"

        document.writeln("<ul class=\"home-download " + gCssClass + " \">");
        writeDownloadItems("fx");
        document.writeln("<\/ul>");
        document.writeln("<div class=\"download-other\">");
        document.writeln("<a href=\"\/<?=$lang?>\/firefox\/all.html\">All Systems &amp; Languages<\/a> | ");
        document.writeln("<a href=\"\/<?=$lang?>\/legal\/privacy\/firefox.html\">Privacy Policy<\/a>");
        document.writeln("<\/div>");
        //-->
    </script>
    <?php echo $firefoxDetails->getNoScriptBlockForLocale('en-US', $_product_details_options); ?>
    </div>

    <p id="beta-promo">Try the new Firefox 4 Beta!
      <a href="/<?=$lang?>/firefox/beta/?WT.mc_id=hp_1&amp;WT.mc_ev=click"
         onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                'DCS.dcsuri', '/<?=$lang?>/firefox/beta',
                                'WT.ti', 'Link: Try the Beta',
                                'WT.dl', 99,
                                'WT.nv', 'Content',
                                'WT.ac', 'Beta');">Free download</a>.
    </p>

</div>

<hr class="hide" />

<div id="main-content">

    <div class="sub-feature" id="sub-firefox">
        <h3>Meet Firefox</h3>
        <p>Get a closer look at the world’s best browser.</p>
        <a href="/<?=$lang?>/firefox/central/"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/central/',
                                  'WT.ti', 'Link: Meet Firefox',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Tour');">
          Take the Tour <span>»</span>
        </a>
    </div>

    <div class="sub-feature" id="sub-security">
        <h3>Firefox Helps You <span>Stay Safe</span></h3>
        <p>Worried about online security? We’ve got your back.</p>
        <a href="/<?=$lang?>/firefox/security/"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/security/',
                                  'WT.ti', 'Link: Stay Safe',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Security');">
          Learn More <span>»</span>
        </a>
    </div>

    <div class="sub-feature" id="sub-performance">
        <h3>Get Ready To <span>Go Fast</span></h3>
        <p>Firefox is built to accelerate the way you use the Web.</p>
        <a href="/<?=$lang?>/firefox/underthehood/"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/underthehood/',
                                  'WT.ti', 'Link: Go Fast',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Go Fast');">
          Learn More <span>»</span>
        </a>
    </div>

    <div class="sub-feature" id="sub-customize">
        <h3>Easy Ways To <span>Personalize</span></h3>
        <p>When it comes to browsing, one size doesn’t fit all.</p>
        <a href="/<?=$lang?>/firefox/customize/"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/customize/',
                                  'WT.ti', 'Link: Personalize',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Customize');">
          Learn More <span>»</span>
        </a>
    </div>

</div>

<!-- Please do not ever remove this comment. -->

<script>
// Includes jquery and then nav-main.js after onload
(function () {
    var head = document.head || document.getElementsByTagName("head")[0];

    function load_nav_main() {
        var scriptElem = document.createElement("script");
        scriptElem.src = "<?php echo $config['static_prefix'];?>/js/nav-main.js";
        head.insertBefore(scriptElem, head.firstChild);
    }

    function load_jquery () {
        var scriptElem = document.createElement("script");
        var scriptdone = false;
        scriptElem.onload = scriptElem.onreadystatechange = function () {
            if ((scriptElem.readyState && scriptElem.readyState !== "complete" && scriptElem.readyState !== "loaded") || scriptdone) {
                return false;
            }
            scriptElem.onload = scriptElem.onreadystatechange = null;
            scriptdone = true;
            load_nav_main();
        };
        scriptElem.src = "<?php echo $config['static_prefix'];?>/js/jquery/jquery.min.js";
        head.insertBefore(scriptElem, head.firstChild);
    };

    var old_onload = window.onload;
    if (old_onload)
    {
        window.onload = function() { old_onload(); load_jquery(); };
    }
    else
    {
        window.onload = load_jquery;
    }
    
})();
</script>

<?php
    include_once "{$config['file_root']}/{$lang}/includes/footer-portal-pages.inc.php";
?>

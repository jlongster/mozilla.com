<?php
    // The $body_* variables are for compatibility with pre-existing css
    $page_title = 'Firefox Future Releases';
    $body_id    = 'channel';
    require_once "{$config['file_root']}/includes/regions.php";
    require_once "{$config['file_root']}/includes/email/forms.php";

    $form = new ChannelsForm(array('AURORA', 'FIREFOX_BETA_NEWS', 'MOZILLA_AND_YOU'), $_POST);
    $status = '';
    if ($form->save()) {
        $status = 'success';
    } elseif ($form->error) {
        $status = 'error error-'. $form->error;
    }
    
    $extra_headers = <<<EXTRA_HEADERS
    <link rel="stylesheet" href="{$config['static_prefix']}/style/covehead/channel.css" media="screen" />
EXTRA_HEADERS;
    include_once "{$config['file_root']}/{$lang}/includes/header.inc.php";

?>

<div id="main-feature">
    <h2>Welcome to the<span>Future of Firefox</span></h2>
    <p>Download and test the build that’s right for you, and sign up for a channel newsletter to stay in the loop.</p>
</div>

<div id="main-content">

    <div id="download_aurora" class="channel">
        <h3><span>Aurora</span></h3>
        <ul class="channel-list">
            <li>Experience the newest innovations in an unstable environment that’s not for the faint of heart</li>
            <li>Provide feedback on features and performance to help determine what makes the final release</li>
        </ul>
        <div id="download_aurora_button">
            <script><?php include $config['file_root'] . '/js/download.old.js';?></script>
            <script>
                <!--
                // Configure the Firefox download write script
                var gDownloadTracker = "";
                var gDownloadItemTemplate = " <li class=\"%CSS_CLASS%\"> <a href=\"%BOUNCER_URL%\" class=\"download-link download-firefox\"><span class=\"download-content\"><span class=\"download-title\">Download</span> Mozilla Firefox Aurora <\/span><\/a> <\/li>";
                var gDownloadItemMacOS9 = "<a href=\"\">MacOS 9 and earlier are not supported<\/a>";
                var gDownloadItemOtherPlatform = "<a href=\"/<?=$lang?>/firefox/<?=LATEST_FIREFOX_VERSION?>/releasenotes/#contributedbuilds\" onclick=\"" + gDownloadTracker + "\">Free Download<\/a>"

                document.writeln("<ul class=\"home-download " + gCssClass + " \">");
                writeDownloadItems("fxaurora");
                document.writeln("<\/ul>");
                document.writeln("<div class=\"download-other\">");
                <!-- document.writeln("<a href=\"\/<?=$lang?>\/firefox\/all.html\">All Systems &amp; Languages<\/a> | "); -->
                <!-- document.writeln("<a href=\"\/<?=$lang?>\/legal\/privacy\/firefox.html\">Privacy Policy<\/a>"); -->
                document.writeln("<\/div>");
                //-->
            </script>
        </div>
    </div>

    <div id="download_beta" class="channel">
        <h3><span>Beta</span></h3>
        <ul class="channel-list">
            <li>Experience cutting edge features but with more stability</li>
            <li>Provide feedback to help refine and polish what will be in the final release</li>
        </ul>
        <p><a href="#channel_news" class="download-soon"><span>Coming Soon!</span> Get notified when Beta is ready.</a></p>
    </div>

    <div id="download_firefox" class="channel">
        <h3><span>Final <span>Release</span></span></h3>
        <ul class="channel-list">
            <li>Enjoy the tried and tested final release being used by hundreds of millions around the world</li>
            <li>Stay in control of your online experience with super speed, easy customization and the latest Web technologies</li>
        </ul>
        <script src="<?php echo $config['static_prefix'];?>/js/download.js"></script>
        <div id="download">
            <script>
                <!--
                // Configure the Firefox download write script
                var gDownloadTracker = "";
                var gDownloadItemTemplate = " <li class=\"%CSS_CLASS%\"> <a href=\"%BOUNCER_URL%\" class=\"download-link download-firefox\"><span class=\"download-content\"><span class=\"download-title\">Download</span> Mozilla Firefox 4 <\/span><\/a> <\/li>";
                var gDownloadItemMacOS9 = "<a href=\"\">MacOS 9 and earlier are not supported<\/a>";
                var gDownloadItemOtherPlatform = "<a href=\"/<?=$lang?>/firefox/<?=LATEST_FIREFOX_VERSION?>/releasenotes/#contributedbuilds\" onclick=\"" + gDownloadTracker + "\">Free Download<\/a>"

                document.writeln("<ul class=\"home-download " + gCssClass + " \">");
                writeDownloadItems("fx");
                document.writeln("<\/ul>");
                document.writeln("<div class=\"download-other\">");
                document.writeln("<a href=\"\/<?=$lang?>\/firefox\/all.html\">All Systems &amp; Languages<\/a> | ");
                document.writeln("<a href=\"\/<?=$lang?>\/legal\/privacy\/firefox.html\">Privacy Policy<\/a>");
                document.writeln("<\/div>");
                //-->
            </script>
        </div>
    </div>

    <div id="channel_news" class="<?= $status ?>">
          <div id="newsletter-signup">
            <div class="title">
              <h3>Get the latest <span>channel news</span></h3>
              <p>Sign up for one or all of our Firefox channel newsletters.</p>
            </div>
            <div class="success-pane">
              <h3>Thanks for subscribing!</h3>
            </div>
            <form id="email-form" action="#newsletter-signup" method="post">
              <input id="email" name="email" type="email" value="<?= $form->get('email') ?>" placeholder="Your email address">
              <div id="email-error">Whoops! Be sure to enter a valid email address.</div>
              <div class="more">
                <div class="row">
                  <select id="country" name="country">
                      <option value="">Select country</option>
                      <?php
                          $country = $form->get('country');
                          if (!$country) {
                              $country = 'us';
                          }
                          echo regionsAsOptions($lang, $country);
                      ?>
                  </select>
                </div>
                <ul class="channels_signup">
                  <li><label for="check_aurora"><input type="checkbox" id="check_aurora" name="aurora" value="t" /> Aurora</label></li>
                  <li><label for="check_beta"><input type="checkbox" id="check_beta" name="beta" value="t" /> Beta</label></li>
                  <li><label for="check_general"><input type="checkbox" id="check_general" name="general" value="t" /> General Mozilla News</label></li>
                </ul>
                <div id="channel-error">Please select at least one newsletter.</div>
                <input name="submit" class="button" type="submit" value="Sign me up!" id="subscribe"
                       onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                'DCS.dcsuri', '/mainstream_newsletter/signup',
                                'WT.ti', 'Link: Sign me up - Second Step',
                                'WT.dl', 99,
                                'WT.nv', 'Content',
                                'WT.ac', 'Newsletter');">
                <p class="footnote">We will only send you Mozilla-related information (<a href="/en-US/privacy-policy">Mozilla Privacy Policy</a>).</p>
              </div>
            </form>
          </div>

    </div>

</div>


</div><!-- end #main-content div -->

<?php
    @include_once "{$config['file_root']}/{$lang}/includes/footer.inc.php";
?>

<?php
    require_once "{$config['file_root']}/includes/min/inline.php";

    $page_title = 'Mozilla | Firefox web browser &amp; Thunderbird email client';
    $body_id    = 'home';

    $fonts      = ' '; // Remove fonts cause IE will download them anyway
    $styles     = ' '; 
    $all_css    = min_inline_css('css');
    $home_css   = min_inline_css('css_home');

    $extra_headers = <<<EXTRA_HEADERS

    <!-- Please do not ever remove this comment. -->
    <meta name="keywords" content="Firefox, Mozilla Firefox, Mozilla, Thunderbird, Thunderbird 2, Thunderbird email, email, Firefox 2, Foxfire, Fire Fox, browser, web browser, internet browser, web, pop-up blocker, internet, speed, secure, customize, online, add-ons, fastest, download Firefox" />
    <meta name="description" content="Mozilla is a global community dedicated to building free, open source products like the award winning Firefox web browser and Thunderbird email software." />
    <meta name="WT.ad" content="Download Firefox;Tour;Security;Go Fast;Customize;Beta" />
    {$all_css}
    {$home_css}
    <style type="text/css">
        body {
            background-image: url("/img/covehead/firefox/direct/page-background.png");
        }
        #home #main-feature {
            zoom: 1;
        }
        #home #main-feature img.screenshot {
            top: auto;
            bottom: 0;
        }
        #home #main-feature img.second-screenshot {
            opacity: 0;
        }
        #home ul#benefits li {
            font-size: 18px;
        }
    </style>
EXTRA_HEADERS;

    $head_scripts = min_inline_js('js_utils');
    include_once "{$config['file_root']}/{$lang}/includes/header.inc.php";
?>
<?php
    // Funnelcake Config
    $_product_details_options = array();
    if (array_key_exists('funnelcake_suffix', $config) && !empty($config['funnelcake_suffix'])) {
        $_product_details_options['tweaks'] = array('/'.LATEST_FIREFOX_VERSION.'/' => LATEST_FIREFOX_VERSION.$config['funnelcake_suffix']);
        echo <<<FUNNEL
<script>// <![CDATA[
  var gDownloadFunnelCake = '{$config['funnelcake_suffix']}';
// ]]></script>
FUNNEL;
    }
?>

<div id="main-feature">
    <h2>Made for sharing.</h2>
    <ul id="benefits">
        <li class="first">Create <span>tabs just </span> <span>for sharing</span></li>
        <li>Customize <span>for faster</span> <span>sharing</span></li>
        <li>Get add-ons <span>for easier</span> <span>sharing</span></li>
    </ul>

    <?=buildPlatformImage($config['static_prefix'].'/img/covehead/firefox/direct/social-facebook.png', 'Firefox screenshot', null, null, 'screenshot second-screenshot', array('mac', 'linux'))?>
    <?=buildPlatformImage($config['static_prefix'].'/img/covehead/firefox/direct/social-twitter.png', 'Firefox screenshot', null, null, 'screenshot', array('mac', 'linux'))?>

    <div id="home-download">
    <script><?php include $config['file_root'] . '/js/download.old.js';?></script>
    <script>
        <!--
        // Configure the Firefox download write script

        var gDownloadTracker = "dcsMultiTrack('DCS.dcssip', 'www.mozilla.com', 'DCS.dcsuri', '/en-US/products/download.html', 'WT.ti', 'Link: Get Firefox', 'WT.dl', 99, 'WT.nv', 'Content', 'WT.ac', 'Download Firefox');";

        var gDownloadItemTemplate = " <li class=\"%CSS_CLASS%\"> <a onclick=\"" + gDownloadTracker + " do_download('%BOUNCER_URL%');\" href=\"%DOWNLOAD_URL%\" class=\"download-link download-firefox\"><span class=\"download-content\"><span class=\"download-title\">Firefox 4 <img src=\"<?=$config['static_prefix']?>/img/home/download-arrow.png\" alt=\"\" id=\"download-arrow\"></span> Free Download <span class=\"download-info\">%VERSION% for %PLATFORM_NAME% <em class=\"download-lang\">%LANGUAGE_NAME%<\/em><\/span><\/span><\/a> <\/li>";
        var gDownloadItemMacOS9 = "<a href=\"\">MacOS 9 and earlier are not supported<\/a>";
        var gDownloadItemOtherPlatform = "<a href=\"/<?=$lang?>/firefox/<?=LATEST_FIREFOX_VERSION?>/releasenotes/#contributedbuilds\" onclick=\"" + gDownloadTracker + "\">Free Download<\/a>"

        document.writeln("<ul class=\"home-download " + gCssClass + " \">");
        writeDownloadItems("fx");
        document.writeln("<\/ul>");
        document.writeln("<div class=\"download-other\">");
        document.writeln("<a href=\"\/<?=$lang?>\/firefox\/all.html\">All Systems &amp; Languages<\/a> | ");
        document.writeln("<a href=\"\/<?=$lang?>\/legal\/privacy\/firefox.html\">Privacy Policy<\/a>");
        document.writeln("<\/div>");
        //-->
    </script>
    <?php echo $firefoxDetails->getNoScriptBlockForLocale('en-US', $_product_details_options); ?>
    </div>

    <p id="mobile-promo">
      <a href="/<?=$lang?>/mobile/?WT.mc_id=hp_1&amp;WT.mc_ev=click"
         onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                'DCS.dcsuri', '/<?=$lang?>/mobile/',
                                'WT.ti', 'Link: Get Firefox on your phone!',
                                'WT.dl', 99,
                                'WT.nv', 'Content',
                                'WT.ac', 'Mobile');">Get Firefox on your phone!</a>
    </p>

</div>

<hr class="hide" />

<div id="main-content" style="margin-top: 0;">

    <div class="sub-feature" id="sub-firefox">
        <h3>Meet Firefox 4</h3>
        <a id="tour-link" href="/<?=$lang?>/firefox/central/"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/central/',
                                  'WT.ti', 'Link: Take the Tour',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Tour');">
          Take the Tour</a>
        <a id="video-link" href="/<?=$lang?>/firefox/video/?video=fx4-features"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/video/?video=fx4-features',
                                  'WT.ti', 'Link: Watch the Video',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Video');">
          Watch the Video</a>
    </div>

    <div class="sub-feature" id="sub-customize">
        <h3>Personalize</h3>
        <p>One size doesn’t fit all.</p>
        <a href="/<?=$lang?>/firefox/customize/"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/customize/',
                                  'WT.ti', 'Link: Personalize',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Customize');">
          Learn More <span>»</span>
        </a>
    </div>

    <div class="sub-feature" id="sub-performance">
        <h3>Go Fast</h3>
        <p>Accelerate the way you use the web.</p>
        <a href="/<?=$lang?>/firefox/performance/"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/performance/',
                                  'WT.ti', 'Link: Go Fast',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Go Fast');">
          Learn More <span>»</span>
        </a>
    </div>

    <div class="sub-feature" id="sub-security">
        <h3>Stay Safe</h3>
        <p>We’ve got your back.</p>
        <a href="/<?=$lang?>/firefox/security/"
           onclick="dcsMultiTrack('DCS.dcssip', 'www.mozilla.com',
                                  'DCS.dcsuri', '/<?=$lang?>/firefox/security/',
                                  'WT.ti', 'Link: Stay Safe',
                                  'WT.dl', 99,
                                  'WT.nv', 'Content',
                                  'WT.ac', 'Security');">
          Learn More <span>»</span>
        </a>
    </div>

</div>

<!-- Please do not ever remove this comment. -->

<script>
// Includes jquery and then nav-main.js after onload
(function () {
    var head = document.head || document.getElementsByTagName("head")[0];

    function load_nav_main() {
        var scriptElem = document.createElement("script");
        scriptElem.src = "<?php echo $config['static_prefix'];?>/js/nav-main.js";
        head.insertBefore(scriptElem, head.firstChild);
    }

    function init_crossfade() {
        $(document).ready(function() {
            var $images = $('#main-feature img.screenshot');
            var currentImage = $images.length - 1;
            var interval = setInterval(function() {
                var nextImage = currentImage + 1;
                if (nextImage == $images.length) {
                    nextImage = 0;
                }

                $from = $($images.get(currentImage));
                $to   = $($images.get(nextImage));

                $from.animate( { opacity: 0 }, 1000);
                $to.animate( { opacity: 1 }, 1000);

                currentImage = nextImage;

            }, 8000);
        });
    }

    function load_jquery () {
        var scriptElem = document.createElement("script");
        var scriptdone = false;
        scriptElem.onload = scriptElem.onreadystatechange = function () {
            if ((scriptElem.readyState && scriptElem.readyState !== "complete" && scriptElem.readyState !== "loaded") || scriptdone) {
                return false;
            }
            scriptElem.onload = scriptElem.onreadystatechange = null;
            scriptdone = true;
            load_nav_main();
            init_crossfade();
        };
        scriptElem.src = "<?php echo $config['static_prefix'];?>/js/jquery/jquery.min.js";
        head.insertBefore(scriptElem, head.firstChild);
    };

    var old_onload = window.onload;
    if (old_onload)
    {
        window.onload = function() { old_onload(); load_jquery(); };
    }
    else
    {
        window.onload = load_jquery;
    }

})();
</script>

<?php
    include_once "{$config['file_root']}/{$lang}/includes/footer-portal-pages.inc.php";
?>
